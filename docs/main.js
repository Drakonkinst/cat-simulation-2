let e=5;const t={setLevel(t){e=t},severe(t){e>=1&&console.error(t)},warn(t){e>=2&&console.warn(t)},info(t){e>=3&&console.log(t)},fine(t){e>=4&&console.log(t)},finer(t){e>=5&&console.log(t)}},n={version:'2.000',saveKey:'game',options:{instantButtons:!1,fasterButtons:!1,fasterTasks:!1,skipIntro:!1,loggerLevel:5}};let o={},s=null,l=null,a=null;function r(e){$('<div>').addClass('notification').css('opacity',0).text(e).prependTo(s).animate({opacity:1},500,'linear',(function(){!function(){let e=l.position().top+l.outerHeight(!0);$('.notification').each((function(){let t=$(this);t.position().top>e&&t.remove()}))}()}))}function d(e){return e.length>0&&!('.!?'.indexOf(e.slice(-1))>-1)&&(t.warn('Message '+e+' does not end with punctuation'),e+='.'),e}function c(e='',t=null,n){e=d(e),null!=t&&O.currentArea!=t?n||(o.hasOwnProperty(t)||(o[t]=[]),o[t].push(e)):r(e)}function h(e){e=d(e),a.stop().text(e).css('opacity',1).animate({opacity:0},3e3,'linear')}function u(e=3e3){$('.notification').stop().animate({opacity:0},e,'linear',(function(){$(this).remove()}))}var p=(()=>{var e=String.fromCharCode,t='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',n='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$',o={};function i(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}var s={compressToBase64:e=>{if(null==e)return'';var n=s._compress(e,6,(e=>t.charAt(e)));switch(n.length%4){default:case 0:return n;case 1:return n+'===';case 2:return n+'==';case 3:return n+'='}},decompressFromBase64:e=>null==e?'':''==e?null:s._decompress(e.length,32,(n=>i(t,e.charAt(n)))),compressToUTF16:t=>null==t?'':s._compress(t,15,(t=>e(t+32)))+' ',decompressFromUTF16:e=>null==e?'':''==e?null:s._decompress(e.length,16384,(t=>e.charCodeAt(t)-32)),compressToUint8Array:e=>{for(var t=s.compress(e),n=new Uint8Array(2*t.length),o=0,i=t.length;o<i;o++){var l=t.charCodeAt(o);n[2*o]=l>>>8,n[2*o+1]=l%256}return n},decompressFromUint8Array:t=>{if(null==t)return s.decompress(t);for(var n=new Array(t.length/2),o=0,i=n.length;o<i;o++)n[o]=256*t[2*o]+t[2*o+1];var l=[];return n.forEach((t=>{l.push(e(t))})),s.decompress(l.join(''))},compressToEncodedURIComponent:e=>null==e?'':s._compress(e,6,(e=>n.charAt(e))),decompressFromEncodedURIComponent:e=>null==e?'':''==e?null:(e=e.replace(/ /g,'+'),s._decompress(e.length,32,(t=>i(n,e.charAt(t))))),compress:t=>s._compress(t,16,(t=>e(t))),_compress:(e,t,n)=>{if(null==e)return'';var o,i,s,l={},a={},r='',d='',c='',h=2,u=3,p=2,f=[],m=0,g=0;for(s=0;s<e.length;s+=1)if(r=e.charAt(s),Object.prototype.hasOwnProperty.call(l,r)||(l[r]=u++,a[r]=!0),d=c+r,Object.prototype.hasOwnProperty.call(l,d))c=d;else{if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(o=0;o<p;o++)m<<=1,g==t-1?(g=0,f.push(n(m)),m=0):g++;for(i=c.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1}else{for(i=1,o=0;o<p;o++)m=m<<1|i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i=0;for(i=c.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1}0==--h&&(h=Math.pow(2,p),p++),delete a[c]}else for(i=l[c],o=0;o<p;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1;0==--h&&(h=Math.pow(2,p),p++),l[d]=u++,c=String(r)}if(''!==c){if(Object.prototype.hasOwnProperty.call(a,c)){if(c.charCodeAt(0)<256){for(o=0;o<p;o++)m<<=1,g==t-1?(g=0,f.push(n(m)),m=0):g++;for(i=c.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1}else{for(i=1,o=0;o<p;o++)m=m<<1|i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i=0;for(i=c.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1}0==--h&&(h=Math.pow(2,p),p++),delete a[c]}else for(i=l[c],o=0;o<p;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1;0==--h&&(h=Math.pow(2,p),p++)}for(i=2,o=0;o<p;o++)m=m<<1|1&i,g==t-1?(g=0,f.push(n(m)),m=0):g++,i>>=1;for(;;){if(m<<=1,g==t-1){f.push(n(m));break}g++}return f.join('')},decompress:e=>null==e?'':''==e?null:s._decompress(e.length,32768,(t=>e.charCodeAt(t))),_decompress:(t,n,o)=>{var i,s,l,a,r,d,c,h=[],u=4,p=4,f=3,m='',g=[],w={val:o(0),position:n,index:1};for(i=0;i<3;i+=1)h[i]=i;for(l=0,r=Math.pow(2,2),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;switch(l){case 0:for(l=0,r=Math.pow(2,8),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;c=e(l);break;case 1:for(l=0,r=Math.pow(2,16),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;c=e(l);break;case 2:return''}for(h[3]=c,s=c,g.push(c);;){if(w.index>t)return'';for(l=0,r=Math.pow(2,f),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;switch(c=l){case 0:for(l=0,r=Math.pow(2,8),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;h[p++]=e(l),c=p-1,u--;break;case 1:for(l=0,r=Math.pow(2,16),d=1;d!=r;)a=w.val&w.position,w.position>>=1,0==w.position&&(w.position=n,w.val=o(w.index++)),l|=(a>0?1:0)*d,d<<=1;h[p++]=e(l),c=p-1,u--;break;case 2:return g.join('')}if(0==u&&(u=Math.pow(2,f),f++),h[c])m=h[c];else{if(c!==p)return null;m=s+s.charAt(0)}g.push(m),h[p++]=s+m.charAt(0),s=m,0==--u&&(u=Math.pow(2,f),f++)}}};return s})();let f={},m=!1;function g(e){let t=e.split(/[.\[\]'"]+/);for(let e=t.length-1;e>=0;--e)t[e].length<=0&&t.splice(e,1);return t}function w(){setInterval(v,6e4)}function v(e=!1){if(m||e){let e=p.compressToUTF16(JSON.stringify(f));localStorage.setItem(n.saveKey,e),m=!1,h('saved.'),t.finer('Saved.')}}function y(e){f=e,v(),t.finer('Loaded state.'),t.finer(f)}function b(){y(JSON.parse(p.decompressFromUTF16(localStorage.getItem(n.saveKey))))}function x(e,t=null){let n=g(e),o=f,i=null;for(let e=0;e<n.length;++e){if(i=n[e],'object'==typeof o&&!o.hasOwnProperty(i))return t;o=o[i]}return o}function C(e,n){return function(e,n){let o,i=g(e),s=f,l=null;for(o=0;o<i.length-1;++o)l=i[o],s.hasOwnProperty(l)||(s[l]={}),s=s[l];l=i[o];let a=s.hasOwnProperty(l);return s[l]=n,m=!0,t.finer('SET '+e+' = '+n),!a}(e,n)}function k(e,n){let o=x(e,0);isNaN(o)?t.severe('Tried to add to "'+e+'" which is not a number.'):C(e,o+n)}var T=Object.freeze({__proto__:null,startAutoSave:w,save:v,load:y,loadFromLocalStorage:b,remove:function(e){let n,o=g(e),i=f,s=null;for(n=0;n<o.length-1;++n){if(s=o[n],!i.hasOwnProperty(s))return!1;i=i[s]}s=o[n];let l=i.hasOwnProperty(s);return l&&(delete i[s],stateChanged=!0,t.finer('REMOVE '+e)),l},get:x,set:C,add:k,getState:function(){return f},printSize:function(){v(),t.info('Compressed Size: '+new Blob(Object.values(localStorage.getItem(n.saveKey))).size/1e3+'kb'),t.info('Uncompressed Size: '+new Blob([JSON.stringify(f)]).size/1e3+'kb')},addItem:function(e,t){k('player.inventory['+e+']',t)},hasItem:function(e,t=1){return x('player.inventory['+e+']',0)>=t}});function A(e){return $(e.target).hasClass('menu-btn')}function S(){return!0}const O={keyLock:!1,navigation:!0,darkMode:!1,darkArea:!1,currentArea:null};function E(e){e?(O.darkMode=!0,$('body').addClass('dark')):(O.darkMode=!1,$('body').removeClass('dark'))}function L(e=null){O.darkArea=e,2==x('options.lights')&&E(!!e)}function I(e){return Math.random()<e}function _(e,t){return e==t?e:Math.random()*(t-e)+e}function M(e,t){return Math.floor(_(e,t))}function P(e){return e[M(0,e.length)]}const N={'american shorthair':{tendencies:['quiet','friendly','playful','calm'],coatColors:['black','blue','silver','brown','tabby'],coatTextures:['short','dense','hard','lustrous'],eyeColors:['blue','copper','green','gold','hazel'],size:'medium'},burmese:{tendencies:['playful','friendly','curious'],coatColors:['blue','platinum','champagne','sable','lilac','fawn','red','cream','chocolate','cinnamon'],coatTextures:['short','silky','glossy','satin'],eyeColors:['gold','yellow'],size:'medium'},'scottish fold':{tendencies:['playful','friendly'],coatColors:['white','blue','black','red','cream','silver'],coatTextures:['short','dense','plush','soft'],eyeColors:['blue','green','gold','bicolored'],size:'medium'},sphinx:{tendencies:['curious','friendly','quiet'],coatColors:['white','black','blue','red','cream','chocolate','lavender'],coatTextures:['hairless','fine'],eyeColors:['blue','red','green','black','pink','grey'],size:'medium'}},B=Object.keys(N),F=['miso','lola','mcgonagall','tara','nala','mistie','misty','coco','tasha','raven','valencia','princess','cherry','chloe','felicia','olivia','emma','belle','luna','minerva','ellie','athena','artemis','poppy','venus','calypso','elise','kathy','elizabeth','hope'],z=['garfield','orpheus','salem','tom','azrael','whiskers','felix','oscar','edgar','sox','ollie','leo','snickers','charcoal','prince','toby','mikesch','buddy','romeo','loki','gavin','momo','illia','theodore','eliot','milo','max','monty','zeke'],j=['lolcat','sesame','unagi','avocado','mango','oreo','swirly','striped','lucky','mittens','angel','dakota','ginger','tippy','snickers','fish','smokey','muffin','fuzzy','nibbles','chaser','pouncer','buttercup'],V=['lazy','playful','loud','quiet','friendly','jumpy','calm','antisocial','curious','active','chaotic','purring','affectionate','intelligent','shy','suspicious','gentle','aggressive','vigilant','hunter','social','dominant'],D=['food','water','litterbox','play','affection','nap'];function U(e){let t=D.indexOf(e);if(t<0)throw'Unknown need "'+e+'"';return t}function R({name:e=null,generateName:t=!0,isFemale:n=I(.5),breed:o=P(B),happiness:i=M(0,101),trust:s=M(0,21),weightClass:l=2}={}){let a=(r=46656*Math.random()|0,d=46656*Math.random()|0,(r=('000'+r.toString(36)).slice(-3))+('000'+d.toString(36)).slice(-3));var r,d;if(null==e&&t){e=P((n?F:z).concat(j))}let c=N[o],h=P(c.coatColors),u=P(c.coatTextures),p=P(c.coatTextures),f=function(e){let t=[];for(let n=0;n<V.length;++n){let o=V[n];e.includes(o)?I(.7)&&t.push(n):I(.02)&&t.push(n)}for(;t.length>5;){let e=M(0,t.length);t.splice(e,1)}return t}(c.tendencies),m=100*l+M(0,100);return new H(a,e,n,o,h,u,p,f,0,0,0,0,0,0,i,s,m)}class H{constructor(e,t,n,o,i,s,l,a=[],r,d,c,h,u,p,f,m,g){this.id=e,this.data={name:t,isFemale:n,breed:o,coatColor:i,coatTexture:s,eyeColor:l,traits:a,needs:[r,d,c,h,u,p],happiness:f,trust:m,weight:g},this.traits=function(e){let t=new Set;for(let n of e)t.add(V[n]);return t}(this.data.traits),this.lastFoodBowl=null,this.lastWaterBowl=null,this.lastLitterbox=null,this.lastNapSpot=null,this.currentRoom=null,this.element=null,this.isSleeping=null,this.currentNeed=null}getHighestNeed(){let e=null,t=-999;for(let n=0;n<D.length;++n){let o=this.data.needs[n];o>t&&(t=o,e=D[n])}return e}setNeed(e,t){let n=U(e);return this.data.needs[n]=t,t}addNeed(e,t){let n=U(e),o=this.needs[n]+t;return this.data.needs[n]=o,o}getNeed(e){let t=U(e);return this.data.needs[t]}}const K={},q={};function J(){}class W{constructor({id:e=null,cooldown:n=0,saveCooldown:o=!1,onClick:i=J,onFinish:s=J,text:l='button',tooltip:a=null,width:r=null}={}){this.id=e,this.cooldown=n,this.onCooldown=this.cooldown>0,this.saveCooldown=o,this.element=function(e,t){let n=$('<div>').addClass('button').text(t).on('click',(()=>e.click()));return $('<div>').addClass('cooldown').appendTo(n),n}(this,l),this.onClick=i,this.onFinish=s,null==this.id&&this.saveCooldown&&t.warn('Button with no ID cannot save cooldown'),this.setTooltip(a),null!=this.id&&this.element.addClass('button_'+this.id),null!=r&&this.element.css('width',r),null!=this.id&&K.hasOwnProperty(this.id)&&this.startCooldown(K[this.id])}static getButton(e){return q[e]}static saveSavedCooldowns(){return JSON.stringify(K)}static loadSavedCooldowns(e){K=JSON.parse(e)}setText(e){return this.element.text(e),this}setTooltip(e){return null!=this.tooltip&&(this.element.removeChild(this.tooltip.element),this.tooltip=null),null!=e&&e.exists()&&(this.tooltip=e,this.tooltip.appendTo(this.element)),this}setCooldown(e){return this.cooldown=e,this}appendTo(e){return this.element.appendTo(e),this}startCooldown(e=null){let t=this.cooldown,n=100;if(null==e||e>t?e=t:n=e/t*100,t<=2)return void this.finish();this.clearCooldown();let o=this;if(this.element.find('.cooldown').width(n+'%').animate({width:'0%'},e,'linear',(()=>{o.clearCooldown(),o.finish()})),this.saveCooldown){K[this.id]=.001*e;let t=setInterval((function(){if(K[this.id]-.5<0)return delete K[this.id],void clearInterval(t);var e,n;K[this.id]=(e=K[this.id]-.5,n=2,+e.toFixed(n))}),500)}this.onCooldown=!0,this.setDisabled(!0)}click(){if(!this.element.hasClass('disabled')){let e=this.onClick();(null==e||e)&&this.startCooldown()}}finish(){this.onFinish()}clearCooldown(){this.onCooldown=!1,this.setDisabled(!1)}setDisabled(e){return e||this.onCooldown?e&&this.element.addClass('disabled'):this.element.removeClass('disabled'),this}}let Q=null,G=null,X=[],Y=[],Z=new Set,ee=null;function te(){return Y.length>0?Y[0]:null}function ne(){return te().eventPanel}function oe(){if(Y.length<=0){let e=[];for(let t of X)t.isAvailable()&&e.push(t);if(!(e.length>0))return void null.scheduleNext(.5);ie(function(e,t=1,n='weight'){let o=0;for(let i of e)i.hasOwnProperty(n)?o+=i[n]:o+=t;let i=_(0,o),s=0,l=0;for(;s<i;){let o=e[l++];o.hasOwnProperty(n)?s+=o[n]:s+=t}return e[l-1]}(e))}null.scheduleNext()}function ie(e,t=!1){if(null!=e.id){if(Z.has(e.id))return;Z.add(e.id)}O.keyLock=!0,O.navigation=!1,t?Y.unshift(e):Y.push(e),e.eventPanel=$('<div>').addClass('event event-panel').css('opacity',0),$('<div>').addClass('event-title').text(e.title).appendTo(e.eventPanel),$('<div>').addClass('event-description').appendTo(e.eventPanel),$('<div>').addClass('event-buttons').appendTo(e.eventPanel),'function'==typeof e.getContext&&(e.context=e.getContext());let n=he('start',e);null!=n.notification&&c(n.notification),(Y.length<=1||t)&&le()}function se(e){let t=ne();$('div.event-title',t).text(e)}function le(){re('start',!0);let e=ne();e.appendTo(ee),$('.event-panel').css('opacity',0),e.animate({opacity:1},200,'linear'),he(Q).blink&&function(){let e=document.title;if(null!=G)return;G=setInterval((()=>{document.title='*** EVENT ***',setTimeout((()=>{document.title=e}),1500)}),3e3)}()}function ae(){let e=ne();e.animate({opacity:0},200,'linear',(()=>{e.remove();let n=te();delete n.eventPanel,delete n.context,Y.shift(),null!=n.id&&Z.delete(n.id),Y.length>0?(le(),t.finer(Y.length+' events remaining')):(null!=G&&(clearInterval(G),G=null),O.keyLock=!1,O.navigation=!0,$('body').trigger('focus'))}))}function re(e,n=!1){t.finer('Loading scene: '+e),Q=e;let o=he(e),i=ne();'function'==typeof o.onLoad&&o.onLoad(),null==o.notification||n||c(o.notification),null!=o.eventTitle&&$('.event-title',i).text(o.eventTitle),$('.event-description',i).empty(),$('.event-buttons',i).empty(),function(e){let t=ne(),n=$('.event-description',t);for(let t=0;t<e.text.length;++t)$('<div>').text(e.text[t]).appendTo(n);if(null!=e.input){document.onselectstart=A,document.onmousedown=A;let t=$('<input>').attr({type:'text',name:'input',spellcheck:!1,placeholder:e.input}).appendTo(n);null!=e.maxinput&&t.attr('maxlength',e.maxinput),$('<div>').addClass('input-result').css('opacity',0).appendTo(n),n.find('input').trigger('focus').trigger('select')}let o=$('<div>').addClass('exit-buttons').appendTo($('.event-buttons',t));null!=e.buttons&&function(e,t){for(let n in e){if(e.hasOwnProperty(n)){let o=e[n],i=o.text;null==i&&(i=n);let s=new W({id:n,text:i,tooltip:o.tooltip||null,onClick:function(){ce(this)},cooldown:o.cooldown}).appendTo(t);null!=o.cooldown&&s.startCooldown()}de()}}(e.buttons,o);$('<div>').addClass('clear').appendTo(o)}(o)}function de(){let e=he(Q).buttons;for(let t in e)if(e.hasOwnProperty(t)){let n=W.getButton(t),o=e[t];null==o.available||o.available()||n.setDisabled(!0)}}function ce(e){let n=he(Q),o=n.buttons[e.id];if(null!=o.click){let e=o.click();if(null!=e&&!e){if('string'==typeof e)if(null==n.input)c(e);else{let t=ne().find('.input-result');0==t.css('opacity')&&(e=d(e),t.text(e).css('opacity',1).animate({opacity:0},1500,'linear'))}return}null!=n.input&&'end'==o.nextScene&&(document.onselectstart=S,document.onmousedown=S)}if(de(),null!=o.notification&&c(o.notification),null!=o.nextScene)if('end'==o.nextScene)e.setDisabled(!0),ae();else if('string'==typeof o.nextScene)re(o.nextScene);else{let e=function(e){let t=0;for(let n in e)e.hasOwnProperty(n)&&(t+=e[n]);let n=_(0,t),o=0;for(let t in e)if(e.hasOwnProperty(t)&&(o+=e[t],o>=n))return t;return null}(o.nextScene);if(null==e)return t.severe('No suitable scene found after "'+Q+'"'),void ae();re(e)}}function he(e,t=null){let n=(t=t||te()).scenes[e];return'function'==typeof n?n(t.context):n}const ue={};class pe{constructor(e,t){this.id=e,this.name=t,this.isVisible=!0,this.element=null,this.buttonElement=null,this.onLoadCallback=()=>{},this.onArrivalCallback=()=>{}}createElement(e,t,n){this.buttonElement=$('<div>').addClass('location-button location-button_'+this.id).text(this.name).on('click',(()=>{e.goToLocation(i)})).appendTo(t),this.element=$('<div>').addClass('location location_'+this.id).appendTo(n),this.onCreateElement()}onCreateElement(){}onLoad(e){return null==e?this.onLoadCallback(this):this.onLoadCallback=e,this}onArrival(e){return null==e?this.onArrivalCallback(this):this.onArrivalCallback=e,this}setName(e,t=!1){this.name=e,this.buttonElement.text(this.name),t&&this.buttonElement.hide().fadeIn(500,'linear')}setVisible(e){return this.isVisible=e,null==this.element||null==this.buttonElement||(e?this.buttonElement.fadeIn(500,'linear'):this.buttonElement.hide()),this}}class fe{constructor(e,t){this.id=e,this.name=t,this.locations=[],this.currentIndex=-1,this.isVisible=!0,this.element=null,this.buttonElement=null}Init(){for(let e of this.locations)e.onLoad(),e.setVisible(e.isVisible);this.goToLocation(0)}onArrival(e){!function(e){if(o.hasOwnProperty(e))for(;o[e].length;)Notifications.printMessage(o[e].shift())}(this.id)}addLocation(e){this.locations.push(e)}addLocations(...e){for(let t of e)this.addLocation(t)}getLocation(e){return e<0||e>=this.locations.length?null:this.locations[e]}goToLocation(e){if(e<0||e>=this.locations.length)return void t.warn('Tried to go to invalid location index '+e);if(this.currentIndex==e)return;let n=this.locations[e];this.element.find('.location-button').removeClass('selected'),n.buttonElement.addClass('selected');let o=this.element.find('.location-content .location-slider'),i=o.find('.location').index(n.element),s=this.currentIndex>-1?this.currentIndex:0,l=Math.abs(i-s);o.animate({top:-624*i+'px'},300*l),n.onArrival(),this.currentIndex=e}createElement(){if(null!=this.element)return this.element;let e=$('<div>').addClass('area-panel area-panel_'+this.id),t=$('<div>').addClass('location-content').appendTo(e),n=$('<div>').addClass('location-select').appendTo(e),o=$('<div>').addClass('location-slider').appendTo(t);for(let e=0;e<this.locations.length;++e)this.locations[e].createElement(this,n,o);return this.element=e,e}setName(e,t=!1){this.name=e,this.buttonElement.text(this.name),t&&this.buttonElement.hide().fadeIn(500,'linear')}setVisible(e){return this.isVisible=e,null==this.element||null==this.buttonElement||(e?(this.buttonElement.fadeIn(200,'linear'),this.element.show()):(this.buttonElement.hide(),this.element.hide())),this}}function me(e){let t=$('<div>').addClass('area-button area-button_'+e.id).text(e.name).on('click',(()=>{ge(e.id)})).appendTo('.area-select');e.buttonElement=t,e.createElement().appendTo('.area-slider'),ue[e.id]=e}function ge(e){if(O.currentArea==e)return;t.finer('Traveling to area '+e);let n=ue[e];if(null==n)return void t.severe('Invalid area '+e);$('.area-button').removeClass('selected'),n.buttonElement.addClass('selected');let o=$('.area-slider'),i=$('.area-panel').index(n.element),s=null==O.currentArea?0:$('.area-panel').index(ue[O.currentArea].element),l=Math.abs(i-s);o.animate({left:-700*i+'px'},300*l),O.currentArea=e,n.onArrival(l)}const we=['a blue sea, waves gently lapping against the shore','dark and stormy nights','dreamed of a blazing inferno, heat unbearable','bright skies and lazy clouds','crackling thunder and pouring rain','soft flakes of snow','merciless ice hurtling from the sky','soft whispers and a warm embrace','fish swimming across the sky','a hunter stalking its prey','a world covered in ash','a land of unyielding stone, not a blade of grass in sight','a blazing radiance, the heat of the sun\'s fury','crimson mist and a wolf\'s howl','a trident buried deep in the sea','a field of stars, glistening in the darkness'];class ve{constructor(e='bottom left'){this.element=$('<div>').addClass('tooltip '+e)}addText(e){return $('<div>').text(e).appendTo(this.element),this}addCost(e,t){return $('<div>').addClass('row_key').text(e).appendTo(this.element),$('<div>').addClass('row_val').text(t).appendTo(this.element),this}append(e){return this.element.append(e),this}appendTo(e){return this.element.appendTo(e),this}exists(){return this.element.children().length>0}}const ye=['dreamed of white sails flying in the salty air.','dreamed of stormy seas and raging tides.','dreamed of a bottomless abyss, rays of light fading away.'],be=['something purrs softly.','feather-soft whiskers brush past.','purring grows more insistent.','something paws gently.'];function xe(e){let t=x('progress.intro.step',0),n=e.getLocation(0);if(n.setName(''),e.setName(''),t<=3){let o=function(e,t){const n=new W({id:'intro',text:'wake up',cooldown:5e3,onClick:()=>{let e=x('progress.intro.step',0);if(e<ye.length){c(ye[e])}else c('the world beckons, and dreams start to fade.'),u()},onFinish:()=>{k('progress.intro.step',1);let o=x('progress.intro.step');o==ye.length&&Ce(e,n),o>=4&&(n.element.remove(),$('.button_random-dream').remove(),Ae(e,t))}}).appendTo(e.element);return n}(n,e);3==t&&Ce(n,o)}t>=4&&Ae(n,e)}function Ce(e,t){c('dream\'s embrace is inviting. would be so nice to give in, just for a while longer.');let n=3;const o=new W({id:'random-dream',text:'dream',cooldown:5e3,onClick:()=>{c('dreamed of '+P(we)+'.')},onFinish:()=>{--n<=0&&(u(),c('dreams fade away like fleeting memories.'),o.setDisabled(!0))}});return o.element.prependTo(e.element),ke=setTimeout($e,1e4),t.setCooldown(8e3),v(),o}let ke=null,Te=0;function $e(){c(be[Te]),Te=(Te+1)%be.length,ke=setTimeout($e,_(1e4,2e4))}function Ae(e,t){t.setName('A Dark Room',!0),new W({id:'sleep',text:'sleep',cooldown:6e4}).appendTo(e.element).setTooltip((new ve).addText('slept enough for now.')).setDisabled(!0),function(e){const t=new W({id:e.id+'-lights',text:'lights on',onClick:()=>{let n='house.room_'+e.id+'.lights',o=x(n,!1);o?(t.setText('lights on'),L(!0)):(t.setText('lights off'),L(!1)),C(n,!o)}});return t}(e).appendTo(e.element).element.one('click',(()=>{t.setName('A Lonely Room')})),L(!0),u(),c('the room is cold.'),setTimeout((()=>{c('a curious face peeks up between the bedsheets.'),ie({title:'A Curious Face',scenes:{start:{text:['a strange creature looks up at you inquisitively.'],buttons:{hello:{text:'say hello',click:()=>{c('nothing here yet.')},nextScene:'end'}}}}})}),3e3),clearTimeout(ke),ke=null,v()}class Se{constructor(e,t=40,n=15){this.element=$('<div>').addClass('display').css({width:.5*t*20-2,height:.5*n*20-2}).appendTo(e),this.boxes=[]}addBox(e,t=!0){this.boxes.push(e),t&&this.drawBoxes()}drawBoxes(){this.element.find('.box').remove();for(let e of this.boxes)e.createElement().appendTo(this.element)}}class Oe{constructor({solid:e=!1,surface:t=!1,height:n=1,width:o=1,x:i=0,y:s=0}={}){this.solid=e,this.surface=t,this.width=o,this.height=n,this.x=i,this.y=s}createElement(){let e=$('<div>').addClass('box').css({width:0==this.width?0:.5*this.width*19-2+1,height:0==this.height?0:.5*this.height*19-2+1,bottom:.5*this.y*19-1,left:.5*this.x*19-1});return 0==this.width&&e.css('border-right','none'),0==this.height&&e.css('border-top','none'),e}}class Ee extends pe{constructor(e,t){super(e,t),this.cats=[]}onCreateElement(){t.info('CREATED'),$('<div>').addClass('room-controls').appendTo(this.element),this.display=new Se(this.element)}onCatArrival(e){this.cats.push(e),e.currentRoom=id;let n='cat_'+e.id,o=$('<span>').addClass('cat '+n).text('@').on('click',(()=>{t.info('Clicked on '+e.name+' ('+e.id+')')}));new ve('bottom right').addText(e.name).appendTo(o),o.css('opacity',0).animate({opacity:1},200,'linear').appendTo(this.display.element)}onCatLeave(e){let n=this.cats.indexOf(e);if(n<0)return void t.warn('Tried to make cat '+e.id+' leave room '+this.id+' but it was not there');this.cats.splice(n,1),e.currentRoom=null;let o='cat_'+e.id,i=this.display.element.find('.'+o);if(i.length){let e=$('<span>').addClass('cat').text('@').css('opacity',1);i.replaceWith(e.animate({opacity:0},200,'linear',(()=>{e.remove()})))}}}const Le=new fe('house','');function Ie(){const e=new Ee('bedroom','Bedroom').onLoad((e=>{x('progress.intro.finished',!1)||xe(Le),new W({text:'cat',onClick:()=>{let e=R();!function(e){C('house.cats['+e.id+']',e.data)}(e),t.info(e)}}).appendTo(e.element),e.display.addBox(new Oe({x:0,y:0,width:10,height:3})),e.display.addBox(new Oe({x:0,y:0,width:3,height:3})),e.display.addBox(new Oe({x:32,y:0,width:0,height:4})),e.display.addBox(new Oe({x:32,y:0,width:2,height:2})),e.display.addBox(new Oe({x:36,y:2,width:5,height:1})),e.display.addBox(new Oe({x:36,y:0,width:0,height:2})),e.display.addBox(new Oe({x:41,y:0,width:0,height:2})),e.display.addBox(new Oe({x:20,y:0,width:4,height:8}))}));Le.addLocations(e,new Ee('hallway','Hallway').setVisible(!1)),me(Le),Le.Init()}const _e=new fe('town','A Quiet Town');function Me(){!function(){let e=$('.main');$('<div>').addClass('area-select').appendTo(e),$('<div>').addClass('area-slider').appendTo(e)}(),Ie(),_e.addLocations(new pe('store','Store').onLoad((()=>{})),new pe('park','Park')),me(_e),_e.Init(),_e.setVisible(!1),function(){let e=$('.area-slider');e.width(700*e.children().length+'px')}()}function Pe(){let e=$('<div>').addClass('footer').appendTo('body');$('<span>').addClass('footer-button version').text('v'+n.version).appendTo(e),$('<span>').addClass('footer-button github').text('github.').on('click',(()=>{window.open('https://github.com/Drakonkinst/cat-simulation-2')})).appendTo(e),$('<span>').addClass('footer-button').text('discord.').on('click',(()=>{window.open('https://discord.gg/Wrp7Fre')})).appendTo(e),$('<span>').addClass('footer-button').text('options.').on('click',(()=>{ie({title:'Options',id:'options',getContext:()=>x('options.lights',0),scenes:{start:e=>({text:['set to heart\'s desire.'],onLoad:()=>{se('Options')},buttons:{lights:{text:Ne(e),click:()=>{let e=x('options.lights',0);var t;e=(e+1)%3,C('options.lights',t=e),0==t?E(!1):1==t?E(!0):2==t&&L(O.darkArea),$('.button.button_lights').text(Ne(e))}},save:{nextScene:'export_import',click:()=>{v()}},restart:{nextScene:'confirm_restart'},close:{nextScene:'end'}}}),confirm_restart:{text:['restart the game?'],onLoad:()=>{se('Restart?')},buttons:{yes:{click:()=>{localStorage.removeItem(n.saveKey),location.reload()},nextScene:'end'},no:{nextScene:'start'}}},export_import:{text:['export or import save data','for backing up or migrating computers'],onLoad:()=>{se('Export / Import')},buttons:{export:{click:()=>{c('nothing here yet.')}},import:{click:()=>{c('nothing here yet.')}},cancel:{nextScene:'start'}}}}},!0)})).appendTo(e)}function Ne(e){let t='lights: ';return 0==e?t+='on':1==e?t+='off':2==e&&(t+='adaptive'),t}function Be(){t.setLevel(n.options.loggerLevel),Pe(),s=$('<div>').addClass('notifications').appendTo('.wrapper'),l=$('<div>').addClass('notify-gradient').appendTo(s),a=$('<div>').addClass('quick-notify').appendTo('.wrapper'),localStorage.hasOwnProperty(n.saveKey)?b():(C('world.day',1),C('options.lights',0),C('progress.unlocked.town',!1)),ee=$('<div>').addClass('events').appendTo('.wrapper'),Me(),w(),window.$SM=T}$((()=>{Be(),ge('house'),new W({text:'Hello, world!',tooltip:(new ve).addCost('soul',1).addText('something\'s out there.'),cooldown:1e3,onClick:()=>{t.info('Hello, world!'),c('Hello, world!'),h('Hello, world!'),oe()}})}));
//# sourceMappingURL=main.js.map
